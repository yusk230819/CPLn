
name: CPLn-Build

on: [push]

jobs:
  build:
    runs-on: windows-latest
    steps:
      # --- ここから追加 ---
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10' # 使うバージョンを指定

      - name: Install Dependencies
        shell: msys2 {0}
        run: |
          pacman -S --noconfirm mingw-w64-x86_64-python # MSYS2環境にPython開発セットを入れる
      # --- ここまで追加 ---

      - name: Install Dependencies
        shell: msys2 {0}
        run: |
          # Python開発セットとSDL2、それらの場所を探すpkg-configをインストール
          pacman -S --noconfirm mingw-w64-x86_64-python mingw-w64-x86_64-pkg-config
          pacman -S --noconfirm mingw-w64-x86_64-sdl2 mingw-w64-x86_64-sdl2_ttf

      - name: Compile
        shell: msys2 {0}
        run: |
          # pkg-configを使って、ライブラリの場所（パス）を自動取得
          PY_FLAGS=$(pkg-config --cflags --libs python3)
          SDL_FLAGS=$(pkg-config --cflags --libs sdl2 SDL2_ttf)
          
          # コンパイル実行（PythonとSDL2の情報をすべて載せる）
          gcc maincpln.c -o CPLn.exe $PY_FLAGS $SDL_FLAGS -lws2_32
